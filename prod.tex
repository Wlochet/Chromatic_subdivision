% EJC papers *must* begin with the following two lines.
\documentclass[utf8,11pt]{article}
\usepackage[utf8]{inputenc}
\usepackage{fullpage}


% Please remove all other commands that change parameters such as
% margins or pagesizes.

% only use standard LaTeX packages
% only include packages that you actually need

% we recommend these ams packages
\usepackage{amsthm,amsmath,amssymb}
\usepackage{algorithm2e}
\newcommand{\qedclaim}{\hfill $\diamond$ \medskip}
\newenvironment{proofclaim}{\noindent{\em Proof of the claim.}}{\qedclaim}

% we recommend the graphicx package for importing figures
%\usepackage{graphicx}

% use this command to create hyperlinks (optional and recommended)
\usepackage[colorlinks=true,citecolor=black,linkcolor=black,urlcolor=blue]{hyperref}

% use these commands for typesetting doi and arXiv references in the bibliography
\newcommand{\doi}[1]{\href{http://dx.doi.org/#1}{\texttt{doi:#1}}}
\newcommand{\arxiv}[1]{\href{http://arxiv.org/abs/#1}{\texttt{arXiv:#1}}}

% all overfull boxes must be fixed;
% i.e. there must be no text protruding into the margins


% declare theorem-like environments
\theoremstyle{plain}
\newtheorem{theorem}{Theorem}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{fact}[theorem]{Fact}
\newtheorem{observation}[theorem]{Observation}
\newtheorem{claim}{Claim}[theorem]

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{open}[theorem]{Open Problem}
\newtheorem{problem}[theorem]{Problem}
\newtheorem{question}[theorem]{Question}

\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{note}[theorem]{Note}

\usepackage{thm-restate}

\newcommand{\william}[1]{{\color{red}{\bf William:} #1}}
\newcommand{\nathann}[1]{{\color{blue}{\bf Nathann:} #1}}

\newenvironment{subproof}{\par\noindent {\it Subproof}.\ }{\hfill$\lozenge$\par\vspace{11pt}}

\newcommand{\cste}{\bf cste}
\newcommand{\qj}{\bf cste2}
\newcommand{\dr}{ k^2}
\newcommand{\col}{(8k^2)^{4k}}
\newcommand{\free}{subdivision-free}

\DeclareMathOperator{\Dis}{Dis}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% if needed include a line break (\\) at an appropriate place in the title

\title{Some paths and chromatic number}



\begin{document}

\maketitle

\section{Definitions and preliminaries}
%%%%%%%%%%%%%%%%%%


We denote by $[k]$ the set of integers $\{1, \dots , k\}$.

Let $F$ be a digraph.
A digraph $D$ is said to be {\it $F$-subdivision-free}, if it contains no subdivision of $F$.

The {\it union} of two digraphs $D_1$ and $D_2$ is the digraph  $D_1\cup D_2$ defined by $V(D_1\cup D_2) = V(D_1)\cup V(D_2)$ and 
$A(D_1\cup D_2) = A(D_1)\cup A(D_2)$.
If ${\cal D}$ is a set of digraphs, we denote by $\bigcup {\cal D}$ the union of the digraphs, i.e. $V(\bigcup {\cal D}) =\bigcup_{D\in {\cal D}} V(D)$
and $A(\bigcup {\cal D}) =\bigcup_{D\in {\cal D}} A(D)$.

\begin{lemma}\label{lem:decomp}
Let $D_1$ and $D_2$ be two digraphs.
$\chi(D_1\cup D_2) \leq \chi(D_1)\times \chi(D_2)$.
\end{lemma}



{\bf def de dipath}

Let $P$ be a path. We denote by $s(P)$ its initial vertex and by $t(P)$ its terminal vertex.
The subpath of $P$ with initial vertex $u$ and terminal vertex $v$ is denoted by $P[u,v]$.
Similarly, if $C$ is a directed cycle, we denote by $C[u,v]$ the subdipath of $C$ with initial vertex $u$ and terminal vertex $v$.


Let $k_1,k_2,k_3$ be positive integers. Let $P(k_1,k_2;k_3)$ be the digraph formed by three internally disjoint paths between two vertices $x,y$, two $(x,y)$-dipaths, one of size at least $k_1$, the other of size at least $k_2$, and one $(y,x)$-dipath of size at least $k_3$.
When we want to insist on the vertices $x$ and $y$, we denote it by $P_{xy}(k_1,k_2;k_3)$.


The {\it connected components} of a digraph are the connected components of its underlying graph.

Let $c$ be a colouring of a graph $G$. A subset of vertices or a subgraph $S$ of $G$ is {\it rainbow-coloured} if all vertices of $S$ have distinct colours.


A (directed) graph $G$ is {\it $k$-degenerate} if every subgraph $H$ of $G$ has a vertex of degree at most $k$.
The following proposition is well-known.
\begin{proposition}[useful??]\label{prop:deg}
Every $k$-degenerate (directed) graph is $(k+1)$-colourable.
\end{proposition}





We will need the following lemmas:

\begin{lemma}[useful??]\label{walk}
Let $D$ be a digraph and $W$ a walk of length $t^l$ such that every vertex appears at most $t$ times.
Then there exists a dipath of length $l$ starting with the first vertex of $W$.
\end{lemma}

\begin{proof}
We do it by induction on $l$. Let $x$ be the first vertex of $W$, because $x$ appears at most $t$ times, there exists a subpath of length greater
than $t^l/t$ not containing $x$. If we apply induction to the longest of such path, then we find a path of length $l-1$ without $x$ such that
 the first vertex is an out-neighbour of $x$.

\end{proof}

\begin{lemma}\label{min}
Let $\sigma=(u_t)_{t\in [p]}$ be a sequence of integers in $[k]$. If $p\geq l^k$, then there exists a set $L$ of $l$ indices such that for any $i,j \in L$ with $i < j$ the following holds : $u_i=u_j$ and $u_k > u_i$, for all $i < k < j$.
\end{lemma}

\begin{proof}
By induction on $k$, the result holding trivially when $k=1$. Assume now that $k>1$. Let $L_1$ be the elements of the sequence with value $1$. If $L_1$ has at least $l$ elements, we are done.
If not then there is a subsequence $\sigma'$ of $l^k/l$ consecutive elements in $\{2, \dots , k-1\}$. Applying the induction hypothesis to $\sigma'$ yields the result.
\end{proof}

\begin{lemma}\label{max}
Let $\sigma=(u_t)_{t\in [p]}$ be a sequence of integers in $[k]$. 
If $p > k (m-1)$, then there exists a subsequence of $m$ consecutive integers such that the
last one is the largest.
\end{lemma}

\begin{proof}
By induction on $k$, the result holding trivially when $k=1$. 
Let $i$ be the smallest integer such that $u_t\leq k-1$ for all $i\leq t\leq p$.
If $i>m$, then $u_{i-1}=k$, and the subsequence of the $i-1$ first elements of $\sigma$ is the desired sequence.
If $i\leq m$, apply the induction on $\sigma'=(u_t)_{i\leq t\leq p}$ which is a sequence of more than $(k-1)(m-1)$ integers in $[k-1]$, to get the result. 
\end{proof}




\section{Negative side}

In ?? they proved the following 
\begin{theorem}
For any positive integer $b$ and $k$, there exists a digraph $D$ such that any cycle in $D_{k,b}$ has at least $b$ blocks and $\chi(D) > k$.
\end{theorem}

\begin{theorem}
For every integer $k$, there exists a $P(1,1;1,1)$ free strongly connected digraph $D$ such that $\chi(D) >k$ 

\end{theorem}

\begin{proof}
Take $D_{k,4}$ given by the previous theorem. Consider the digraph $D$ obtained from $D_{k,4}$ as follows: Add two new vertices $x$ and $y$, the arc $xy$
,for every vertex $u$ of out degree $0$ add the arc $ux$ and for every vertex $v$ of indegree 0 the arc $yv$. It is easy to see that $D$ is strongly connected.
Moreover, in $D_{k,4}$, every directed cycle uses the arc $xy$, therefore $D$ does not contain any subdivision of $P(1,1;1,1)$. 
\end{proof}




\section{$P(k,1;1)$}

\begin{theorem}\label{th:P11k}
Let $D$ be a strongly connected digraph. If $\chi(D) >  (k+1) (2k)$ then $D$ contains a subdivision of $P(1,1;k)$
\end{theorem}

A collection ${\cal C}$ of directed cycles is {\it suitable} if all cycles of ${\cal C}$ have length at least $2k$, and for
any two distinct cycles $C_i,C_j\in\mathcal C$, they intersect on at most one vertex. When this intersection exists, we call it $x_{i,j}$.
A {\it component} of $\mathcal{C}$ is a connected component in the graph of adjacency of the cycles of $C$, where vertices correspond to cycles in $\mathcal{C}$
and two vertices are adjacent if the cycles intersect. 
Call $D_{\mathcal{C}}$ the digraph obtained from $D$ by contracting each component of $\mathcal{C}$ into one vertex. 

We will prove that every $P(1,1;k)$ subdivision-free strong digraph $D$ has bounded chromatic number in the following way:
Take ${\cal C}$ a maximal suitable collection of cycle. 
We will prove that every component $S$ of ${\cal C}$ induces a digraph $D[S]$ on $D$ of bounded chromatic number. 
Then we will prove that, since it doesn't contains large directed cycle and it is strongly connected, $D_{\mathcal{C}}$ has bounded chromatic number.
Finally we will, using the two previous results exhibit a colouring of $D$.

We will need the following lemma:

\begin{lemma}\label{lem:headphone}
Let ${\cal C}$ be a suitable collection of cycle in a $P(k,1;1)$ subdivision-free digraph $D$ and $C_i$, $C_j$ two cycles of the same
component $S$ of $\mathcal{C}$. There is no path $P_S$ between $C_i$ and $C_j$ which uses only edges outside of $S$.  
\end{lemma}

\begin{proof}
We suppose there exists an $x-y$ dipath $P_S$ between $x \in C_i$ and $y \in C_j$ and show that we can find a subdivision of $P(k,1;1)$. 
By definition of $S$ there exists a sequence of cycles $C_1, C_2, \dots C_l$ such that $C_1 = C_i$, $C_l = C_j$ and $x_{s,s+1}$ exists for $s$ between $1$ and $l-1$.
On $C_1$, either $C_1[x_{1,2}, x]$ or $C_1[x, x_{1,2}]$ is longer than $k$. 
Let $P$ be the path from $x_{l-1,l}$ to $x_{1,2}$ using, outside of its ends, only vertices in $C_s$ for $s$ between $2$ and $l-1$ (if $l = 2$ then
$x_{l-1,l} = x_{1,2}$ and $P = x_{1,2}$ works).
\begin{itemize}
	\item If $C_1[x_{1,2}, x]$ is longer than $k$ then we find a subdivision of $P(k,1;1)$ between $x_{l-1,l}$ and $y$. 
	The first path of the subdivision of $P(k,1;1)$ is $P \odot C_1[x_{1,2}, x] \odot P_S$, the second is 
	$C_l[x_{l-1,l}, y]$ and the third is $C_l[ y, x_{l-1,l}]$
	\item If $C_1[x, x_{1,2}]$ is longer than $k$ then we find a subdivision of $P(k,1;1)$ between $x$ and $x_{1,2}$.
	The first path is $C_1[x, x_{1,2}]$, the second is $P_S \odot C_l[y, x_{l-1,l}] \odot P$ and the third is $C_1[x_{1,2}, x]$. 
\end{itemize}
\end{proof}

 
\begin{lemma}\label{lem:compo1}
Let ${\cal C}$ be a suitable collection of cycle in a $P(k,1;1)$ subdivision-free digraph $D$ and $S$ a component of $\mathcal{C}$, then $\chi(D[S]) < k+1$.	 
\end{lemma}

\begin{proof}
We do it by induction on the number of cycle in $S$. Let $C$ be a cycle of $S$. Since $C$ is longer than $2k$, there is no cords between $x$ and $y$ in $C$
such that $C[x,y]$ is longer than $k$. This means that $C$ is $k+1$ degenerate and has chromatic number smaller than $k +1$. Let $c$ be a colouring of $C$ with
$k$ colours. Let $S_1, S_2, \dots, S_r$ be the components containing cycles of $S$ in $\mathcal{C} \setminus{C}$. Since $S$ is exactly the union of the $S_i$ and $C$
then each $S_i$ has strictly less cycle than $S$. By induction there exists a colouring $c_i$ using $k+1$ colours for each $S_i$.
 
Now we claim that the intersection of each $D[S_i]$ with $C$ is exactly one vertex. It is easy to see that $C$ must intersect at least one cycle of each $S_i$, 
now suppose there exists two vertices of $C$, $x$ and $y$ who belongs to $D[S_i]$. By definition of a suitable collection, they cannot belong to the same cycle 
of $S_i$, so there exists two cycles $C_i$ and $C_j$ of $S_r$ such that $x \in C_i$ and $y \in C_j$. By lemma \ref{lem:headphone} where $C[x,y]$ plays the role
of $P_S$, it is not possible. This means, modulo a permutation of the $c_i$,
that we can consider that each vertex of $C$ receives the same colour in $c$ and in the $c_i$. 

Moreover, because of lemma \ref{lem:headphone}, there is no edge between different $S_i$ and between $S_i$ and $C$. This means that if we take the union of the 
$c_i$ and $c$, we obtain a proper colouring of $D[S]$ using $k+1$ colours. 
\end{proof}


\begin{lemma}\label{lem:reduce}
Let ${\cal C}$ be a maximal suitable collection of cycle in a $P(k,1;1)$ subdivision-free strongly connected digraph $D$. Then $\chi(D_{\mathcal{C}}) < 2k$
\end{lemma}

\begin{proof}
First note that, since $D$ is strongly connected,  so is $D_{\mathcal{C}}$. Suppose $\chi(D_{\mathcal{C}}) \geq 2k$, by Bondy's Theorem, there exists a directed cycle
$C = x_1\dots x_l$ of length greater than $2k$ in $ D_{\mathcal{C}}$. We deduce a cycle $C'$ in $D$ the following way:
Suppose the vertex $x_j$ corresponds to a component $S_i$ in $D$: the arc $x_{j-1}x_j$ corresponds in $D$ to an arc arriving on 
$p_i$, a vertex of $S_i$ and the arc $x_jx_{j+1}$ corresponds to an arc leaving $l_i$, a vertex of $S_i$. Let $P_j$ be the dipath 
from $p_i$ to $l_i$ in $D[S_i]$. Note that $P_j$ intersect each cycle of $S_i$ on a, possibly empty, subpath of $P_j$. 
Then $C'$ is the cycle obtained from $C$ by replacing the vertices $x_i$ which correspond to a component of $\mathcal{C}$ in $D$ by the path $P_j$.

$C'$ is a cycle of $D$ which is longer than $2k$ because it is longer than $C$. Let $C_1$ be a cycle of $\mathcal{C}$, then by construction of $C'$ 
and $D_{\mathcal{C}}$, $C'$ and $C_1$ can intersect only along a subpath of one $P_j$. Suppose this intersection is more than just a vertex and call $x$ and
$y$ the first and last vertices of this intersection. Then we find a subdivision of $P(k,1;1)$ between $x$ and $y$. The first is $C'[x,y]$ and the other are
$C[x,y]$ and $C[y,x]$.

So $C'$ is a cycle longer than $2k$, intersecting cycles of $\mathcal{C}$ on at most one vertex, and which does not belong to $\mathcal{C}$, or it would be reduced
to one vertex in $D_{\mathcal{C}}$, which contradicts the fact that $\mathcal{C}$ is maximal.
\end{proof}

So we can finally prove Theorem \ref{th:P11k}

\begin{proof}
Let ${\cal C}$ be a maximal suitable collection of cycle in $D$. By lemma \ref{lem:compo1}, for each component $S_i$ of $\mathcal{C}$, there exists a colouring
$c_i$ using colours in $[k+1]$ and by lemma \ref{lem:reduce} there exists a colouring $c'$ of $D_{\mathcal{C}}$ using colours in $[2k]$. 
Define $c : V(D) \rightarrow ([k+1],[2k])$ as follows. If $x$ is a vertex belonging to some component $S_i$ of $\mathcal{C}$ and $s_i$ 
is the vertex corresponding to $S_i$ in $D_{\mathcal{C}}$, then $c(x) = (c_i(x), c'(s_i))$, else $c(x) =(1,c'(x))$. 
Let $x$ and $y$ be adjacent vertices of $D$. If they belong to the same component $S_i$, then $c_i(x) \not = c_i(y)$ and $c(x) \not = c(y)$. If they don't belong
to the same component, then the vertices corresponding to these vertices in $D_{\mathcal{C}}$ will be adjacent and $c(x) \not = c(y)$. 
Thus $c$ is a proper colouring of $D$ using $(k+1)(2k)$ colours. 
\end{proof}


\section{$P(k,1;k)$}
%%%%%%%%%%%

\begin{theorem}\label{th:main}
Let $D$ be a strongly connected digraph. If $\chi(D) > \cste$, then $D$ contains a subdvision of $P(k,1;k)$.
\end{theorem}


We prove the result by the contrapositive. We consider a digraph $D$ that contains no subdivision of $P(k,1;k)$.
We shall prove that $\chi(D) \leq \cste$.

\subsection{Suitable collections of directed cycles}
%%%%%%%%%%%%%%%%%%%%%%%%%
 
 A collection ${\cal C}$ of directed cycles is {\it suitable} if all cycles of ${\cal C}$ have length at least $12k$, and for
any two distinct cycles $C_i,C_j\in\mathcal C$ intersect on  subpath $P_{i,j}$ of order at most $k$.
We denote by $s_{i,j}$ (resp. $t_{i,j}$) the initial (resp. terminal) vertex of  $P_{i,j}$.
 
 
 
 \begin{lemma}\label{lem:dis}
 Let ${\cal C}$ be a suitable collection of directed cycles in a $P(k,1;k)$-\free\ digraph.
Let $C_1,C_2,C_3\in\mathcal C$ pairwise intersect, and let $v$ belong to $V(C_2)\cap V(C_3)\setminus V(C_1)$. Then exactly one of the following holds:
\begin{itemize}
\item $C_2[t_{1,2}, v]$ and $C_3[t_{1,3}, v]$ have both length at most $4k$; 
\item $C_2[v, s_{1,2}]$ and $C_3[v, s_{1,3}]$ have both length at most $4k$.
\end{itemize}
\end{lemma}

\begin{proof}
Suppose it is not the case. By symmetry, we may assume that $C_3[t_{1,3},v]$ has length at most $4k$ and
$C_2[v, s_{1,2}]$ has length at most $4k$, so  $C_2[t_{1,2},v]$ has length greater than $4k$.

Observe that $t_{2,3}\notin V(C_1)$ for otherwise $C_3[v,t_{1,3}]$ has length less than $2k$ (since it is contained in $P_{2,3}\cup P_{1,3}$ and each of those paths has length at most $k-1$ by definition of ${\cal C}$) and so $C_3[t_{1,3},v]$ has length at least $10k$, a contradiction.
We distinguish two cases according to the position of $s_{1,3}$ in $C_1$ relatively to $s_{1,2}$ and $t_{1,2}$.

\begin{itemize}
	\item Assume $s_{1,3}\in C_1[s_{1,2},t_{1,2}]$. The dipath  $C_3[s_1,3,t_{2,3}]$ is contained in $P_{1,2}\cup P_{2,3}$ and has lentgh less than $2k$. So $C_3[t_{2,3}, s_{1,3}]$ has length at least $k$. Moreover, $C_1[s_{1,3}, t_{1,2}]\odot C_2[t_{1,2}, t_{2,3}]$ contains $C_1[t_{1,2}, v]$  and so has legth at least $4k$. Consequently, the union of $C_1[s_{1,3}, t_{1,2}]\odot C_2[t_{1,2}, t_{2,3}]$, $C_3[t_{2,3}, s_{1,3}]$, and
$C_2[t_{2,3}, s_{1,2}]\odot C_1[s_{1,2}, s_{1,3}]$ is a subdivision of $P(k,1;k)$, a contradiction.

	\item Assume now that $s_{1,3}\in C_1[t_{1,2},s_{1,2}]$. The dipath  $C_2[s_{1,2}, t_{2,3}]$ has length greater than $4k$ because it contains $C_2[t_{1,2},v]$. Moreover, the dipath $C_3[s_{1,3}, t_{2,3}]$ is contained in $P_{1,3}\cup C_3[t_{1,3},v]$, and so has length at most $5k$.
	Thus $C_3[t_2,3, s_{1,3}]$ has length at least $7k$.
	 Consequently, the union of $C_2[s_{1,2}, t_{2,3}]$, $C_3[t_2,3, s_{1,3}]\odot C_1[s_{1,3}, s_{1,2}]$, and $C_2[t_{2,3}, s_{1,2}]$ is a subdivision of $P(k,1;k)$, a contradiction.
\end{itemize}
\end{proof}
 
 
 
 
 
 
% Let $D[\mathcal{C}]$ be the graph induced on $D$ by the vertices in $\mathcal{C}$ and let $D'$ be the subdigraph of $D[\mathcal{C}]$ with vertex set $V(D)$ and arc set  $\bigcup_{C\in {\cal C}} A(C)$.

Let ${\cal C}$ be a suitable collection of directed cycles.
For every set of vertices or digraph $S$, we denote by ${\cal C}\cap S$ the set of cycles of ${\cal C}$ that intersect $S$. 



Let $C_1\in \mathcal{C}$.
For each $C_j\in {\cal C} \cap C_1$, let $Q_j$ be the subdipath of $C_j$ 
containing all the vertices that are at distance at most $4k$ from $P_{1,j}$ in the cycle underlying $C_j$.
Then the dipath $C_j[s(Q_j), s_{1,j}]$ and  $C_j[t_{1,j},t (Q_j)]$ have length $4k$.
Set $Q^-_j=C[s(Q_j), s_{1,j}[$ and $Q^+_j=C]t_{1,j}, t(Q_j)]$.


Set $I^+(C_1) = \bigcup_{C_j\in {\cal C}\cap C_1} Q^+_j$ and $I^-(C_1) = \bigcup_{C_j\in {\cal C}\cap C_1} Q^-_j$.
Observe that Lemma~\ref{lem:dis} implies that $I^+(C_1)$ and $I^-(C_1)$ are vertex-disjoint digraphs. We set $I(C_1)=I^+(C_1)\cup I^-(C_1)$.




\begin{lemma}\label{lem:A}
Let ${\cal C}$ be a suitable collection of directed cycles in a $P(k,1;k)$-\free\ digraph.
Let $C_1$ be a cycle of ${\cal C}$ and let $A$ be a connected component of $\bigcup{\cal C} - I(C_1)$.
All vertices of $({\cal C}\cap A)  - A$ belongs to a unique cycle $C_A$ of $\mathcal{C}$.
\end{lemma}

\begin{proof}
Suppose it is not the case. Then there are two distinct cycles $C_2, C_3$ of ${\cal C}\cap A$ that intersect with $C_1$.

Let $t$ be the closest vertex among $\{t_{1,2}, t_{1,3}\}$ in $C_1$ and let $t'$ be the other vertex of $\{t_{1,2}, t_{1,3}\}$.
(If $t_{1,2}=t_{1,3}$, then $t=t'$.) For $i=2,3$, let $R_i$ be the $(t,t(Q_i)$-dipath in $C_1\cup Q_i$. Observe that $R_i=Q_i$ or $R_i=C_1[t,t']\cup Q_I$. Hence $R_i$ has length at least $4k$.
Let $v$ be the last vertex in $R_2\cap R_3$ along $R_2$. (This vertex exists since $t\in R_2\cap R_3$.) In $A$, there exists a $(t(Q_3), C_2)$-dipath $R_A$. Let $w$ be its terminal vertex. By definition of $A$, $w$ is in $C_2[t(Q_2, s(Q_2)]$, therefore $C_2[w,v]$ has length at least $4k$ since it contains $C_2[s(Q_2), s_{1,2}]$. Consequently, both $R_2[v,t(Q_2)]$ and $R_3[v,t(Q_3)]$ have length less than $k$ for otherwise the union of $C_2[w,v]$, $C_2[v,w]$ and $R_3[v,t(Q_3)]\odot R_A$ would be a subdivision of $P(k,1;k)$.
In particular, $v\neq t$. This implies that $s_{2,3}\in V(R_2\cap R_3)$.
Moreover, $R_2[s_{2,3}, t(Q_2)]$ has length at most $2k$ because $R_2[s_{2,3},v]$ is a subdipath of $P_{2,3}$ and so has length at most $k$.
Therefore $R_2[t,s_{2,3}]$ has length at least $2k$ because $R_2$ has length at least $4k$.
It follows that the union of $C_2[s_{2,3},t]$,  $R_2[t,s_{2,3}]$ and  $R_3[t,s_{2,3}]$ is a subdivision of $P(k,1;k)$, a contradiction.
\end{proof}




\begin{lemma}\label{lem:no-dicycle}
Let ${\cal C}$ be a suitable collection of directed cycles in a $P(k,1;k)$-\free\ digraph. For any cycle $C_1\in {\cal C}$, the digraph
$I^+(C_1)$ has no directed cycle.  
\end{lemma}
\begin{subproof}
Suppose for a contradiction that $I^+(C_1)$  contains a directed cycle $C'$.
Clearly, it must contain arcs from at least two $Q^+_j$.



Assume that $C'$ contains several vertices of $Q^+_j$.
Necessarily, there must be two vertices $x,y$ of $Q^+_j\cap C'$ such that no vertex of $C']x,y[$ is in $C_j$ and  $y$ is before $x$ in $Q^+_j$.
Therefore $C'[x,y]\odot Q^+[y,x]$ is also a directed cycle in $I^+(C_1)$. Free to consider this cycle,
we may assume that $C'\cap Q^+_j$ is a directed path.

Doing so, for all $j$, we may assume that $C'\cap Q^+_j$ is a directed path  for every $C_j\in {\cal C}\cap C_1$.
Without loss of generality, we may assume that there are cycles $C_2, \dots , C_p$ such that
\begin{itemize}
\item $C'$ is in $Q^+_2\cup \cdots  \cup Q^+_p$;
\item for all $2\leq j\leq p$, $C'\cap Q^+_j$ is a directed path $P^+_j$ with initial vertex $a_j$ and terminal vertex $b_j$;
\item the $a_j$ and the $b_j$ appear according to the following order around $C'$: $(a_2, b_p, a_3, b_2, \dots ,   a_p, b_{p-1}, a_2)$ with possibly $a_{j+1}=b_j$ for some $1\leq j \leq p$ where $a_{p+1}=a_2$.
\end{itemize}
For $2\leq j\leq p$, set $B_j=C_j[b_j, a_j]$. Note that $B_j$ has length at least $7k$, because $Q^+_2$ has length at most $5k$.


Consider the closed directed walk $$W=C_p[a_2,b_p]\odot B_p \odot C_{p-1}[a_p, b_{p-1}] \odot  \cdots  \odot  B_3\odot C_2[a_3, b_2]\odot B_2.$$
$W$ contains a directed cycle $C_W$. Wihtout loss of generality, we may assume that this cycle is of the form
$$C_W=B_q[v, a_q] \odot C_{q-1}[a_q, b_{q-1}] \odot  \cdots  \odot  B_3\odot C_2[a_3, b_2]\odot B_2[b_2, v]$$
for some vertex $v\in B_2\cap B_r$. (The case when $W$ is a directed cycle corresponds to $q=p+1$ and $B_2=B_{p+1}$.)

Note that necessarily, $q\geq 4$, for $B_3$ does not intersect $B_2$, for otherwise $b_3=b_2$ since the intersection of $C_2$ and $C_3$ is a dipath.

Observe that $C_W[b_2,v]=C_2[b_2,v]$ or $C_W[v, a_4]$ has length at least $k$.
Indeed, if $q=p+1$, then it follows from the fact that $B_2$ has length as least $7k$; if
$5\leq q\leq p$, then it comes form the fact that $B_4$ is a subdipath of $C_W[v, a_r]$; if $q=4$, then it follows from Lemma~\ref{lem:dis}  applied to $C_3$, $C_2$, $C_4$ in the role of $C_1$, $C_2$, $C_3$ respectively.
In both case, $C_W[b_2, a_4]$ has length at least $k$. 

Furthermore, $C_W[a_4,b_2]$ has length at least $k$ because it contains $B_3$. Therefore the union of
$C_W[b_2, a_4]$, $C_W[a_4,b_2]$ and $C'[b_2,a_4]=C_3[b_3,a_4]$ is a subdivision of of $P(k,1;k)$, a contradiction.
\end{subproof}




\begin{lemma}\label{lem:IC}
Let ${\cal C}$ be a suitable collection of directed cycles in a $P(k,1;k)$-\free\ digraph.

Let $c$ be a partial colouring of a cycle $C_1\in {\cal C}$ such that only a path of length at most
$9k$ is coloured and this path is rainbow-coloured. Then $c$ can be extended into
a colouring of $C_1\cup I(C_1)$ using $2\cdot \col + 18k$ colours, such that every subpath of length at most $9k$ of $C_1$ is rainbow-coloured and  $Q_j$ is rainbow-coloured, for every $C_j\in {\cal C}\cap C_1$.\end{lemma}

\begin{proof}
We can easily extend $c$ to $C_1$ using $18k$ colours (including the at most $9k$ already used colours)
so that every subpath of $C_1$ of length $9k$ is rainbow-coloured.

We shall now prove that there exists a colouring $c^+$ of $I^+(C_1)$ with $\col$ (new) colours so that $Q^+_j$ is rainbow-coloured for every $C_j\in {\cal C}\cap C_1$, and a colouring $c^-$ of $I^-(C_1)$ with $\col$ (other new) colours so that $Q^-_j$ is rainbow-coloured for every $C_j\in {\cal C}\cap C_1$.
The union of these three colourings is clearly the desired colouring of $C_1\cup \bigcup{\cal C}[I(C_1)]$. (Observe that a vertex of $I(C_1)$ is coloured only once because  $I^+(C_1)$ and $I^-(C_1)$ are disjoint.)

It remains to prove the existence of $c^+$ and $c^-$. By symmetry, it suffices to prove the existence of $c^+$.
 To prove the existence of $c^+$ we consider an auxilary digraph $D^+_1$.
 For each $C_j\in {\cal C}\cap C_1$, let $T^+_j$ be the transitive tournament whose hamiltonian dipath is $Q^+_j$.
Let $D^+_1=\bigcup_{C_j\in  {\cal C}\cap C_1} T^+_j$. 
The arcs of the $A(T^+_j)\setminus A(Q^+_j$ are called {\it fake arcs}.
%Observe that $D^+_1$ is acyclic because $I^+(C_1)$ is. Indeed, if there were a directed cycle
%cycle in $D^+_1$, it could be transformed into a closed directed walk (by replacing each arc $(u,v)\in A(T^+_j)$, by 
%$Q^+_j[u,v]$), which would contain a directed cycle.
Clearly, $c^+$ exists if and only if $D^+_1$ admits a proper colouring. Henceforth it remains to prove the following claim.

\begin{claim}
$\chi(D^+_1) \leq  \col$.
\end{claim}

\begin{subproof}
To each vertex $v$ in $I^+(C_1)$ we associate the set $\Dis(v)$ of the lengths of the $C_j[t_{1,j},v]$ for all cycle $C_j\in {\cal C} \cap C_1$ containing $v$ such that $C_j[t_{1,j},v]$ has length at most $4k$.


Suppose for a contradiction that $\chi(D^+_1) \leq  \col$.
By Gallai-Roy Theorem, $D^+_1$ admits a directed path of length $\col$. Replacing all fake arcs  $(u,v)$ in some $A(T^+_j)$, by 
$Q^+_j[u,v]$ we obtain a directed walk $P$ in $I^+(C_1)$ of length at least $\col$. By Lemma \ref{lem:no-dicycle}, $P$ is necessarily a directed path. Set $P=(v_1,  \dots , v_{p})$. We have $p\geq \col$.

For $1\leq i\leq p$, let $m_i = \min \Dis(v_i)$. 
Lemma \ref{min} applied to $(m_i)_{1\leq i\leq p}$ yields  a set of $8k^2$ indices of such that 
for any $i< j \in L$,  $m_i=m_j$ and $m_k > m_i$, for all $i< k < j$.
Let $l_1 < l_2 < \cdots < l_{8k^2}$ be the elements of $L$ and let $m= m_{l_1} = \cdots = m_{l_{8k^2}}$.


For $1\leq j\leq 8k^2-1$, let $M_j = \max \bigcup_{l_j\leq i < l_{j+1}} \Dis(v_i)$.
By definition $M_j\leq 4k$.
Applying Lemma~\ref{max} to $(M_j)_{1\leq j\leq 8k^2}$,  we get a sequence of size $2k$ $M_{j_0+1} \dots M_{j_0+{2k}}$ such that $M_{j_0+{2k}}$ is the greatest. For sake of simplicity, we set $\ell_i =j_0+i$ for $1\leq i\leq 2k$.
Let $f$ the smallest index not smaller than $\ell_{2k}$ for which $M_{\ell_{2k}} \in \Dis (v_f)$. 

Let $j_1$ be an index such that $C_{j_1}[t_{1,j_1},v_{\ell_1}]$ has length $m$ and set $P_1=C_{j_1}[t_{1,j_1},v_{\ell_1}]$.
Let $j_2$ be an index such that $C_{j_2}[t_{1,j_2},v_{\ell_k}]$ has length $m$ and set $P_2=C_{j_2}[t_{1,j_2},v_{\ell_k}]$.
Let $j_3$ be an index such that  $C_{j_3}[t_{1,j_3},v_{f}]$ has length $M_{\ell_{2k}}$ and set $P_3=C_{j_3}[v_f, s_{1,j_3}]$ (some vertices of $P_3$ are not in $I^+(C_1)$).

Note that any internal vertex $x$ of $P_1$ or $P_2$ has an integer in $\Dis(x)$
which is smaller than $m$ and every internal vertex $y$ of $P_3$ has an integer in $\Dis(y)$ which
is greater than $M_{\ell_{2k}}$, or does not belong to $I^+(C_1)$. Hence, 
$P_1$, $P_2$ and $P_3$ are disjoint from $P[v_{\ell_1},v_f]$. 


We distinguishes between the intersection of $P_1$, $P_2$ and $P_3$:

\begin{itemize}
	\item Suppose $P_3$ does not intersect $P_1 \cup P_2$.
	\begin{itemize}
		\item Assume first that $P_1$ and $P_2$ are disjoint. If $s(P_1)$ is in $C_1[t(P_3), s(P_2)]$, then the union of  $P_1 \odot P[v_{\ell_1}, v_{\ell_k}]$, $P[v_{\ell_k}, v_f] \odot P_3\odot C_1[t(P_3), s(P_1)]$ and $C_1[s(P_1), s(P_2)]\odot P_2$ is a subdivision of $P(k,1;k)$, a contradiction.
		 If $s(P_1)$ is in $C_1[ s(P_2), t(P_3)]$, then the union of  $C_1[s(P_2), s(P_1)]\odot P_1\odot P[v_{\ell_1}, v_{\ell_k}]$, $P[v_{\ell_k}, v_f]\odot  P_3\odot C_1[t(P_3), s(P_2)]$, and  $P_2$ is a subdivision of $P(k,1;k)$, a contradiction.
	
		\item Assume now $P_1$ and $P_2$ intersect. Let $u$ be the last vertex along $P_2$ on which they intersect. The union of $P_1[u,v_{\ell_1}]\odot P[v_{\ell_1}, v_{\ell_k}]$, $P[v_{\ell_k}, v_f]\odot P_3\odot C[t(P_3), s(P_1)]\odot P_1[s(P_1), u]$, and $P_2[u, v_{\ell_k}]$ is a subdivision of $P(k,1;k)$, a contradiction.
	\end{itemize}

	\item Assume $P_3$ intersect $P_1\cap P_2$. Let $v$ be the first vertex along $P_3$ in $P_1\cap P_2$ and let $u$ be the last vertex of $P_1\cap P_2$ along $P_2$. The union of $P_1[u,v_{\ell_1}]\odot P[v_{\ell_1}, v_{\ell_k}]$, $P[v_{\ell_k}, v_f]\odot P_3[v_f,v]\odot P_1[v, u]$, and $P_2[u, v_{\ell_k}]$ is a subdivision of $P(k,1;k)$, a contradiction.

	\item Assume now that $P_3$ intersect $P_1\cup P_2$ but not $P_1\cap P_2$. Let $v$ be the first vertex along $P_3$ in $P_1\cup P_2$.
	\begin{itemize}
	\item If $v \in P_2$, let $u$ be the last vertex on $P_2\cap P_3$ along $P_3$. Observe that $P_3[v,u]$ is also a subpath of $P_2$ and therefore contains no vertex of $P_1$. Furthermore, there is a dipath $Q$ from $u$ to $v_{\ell_1}$ in $P_3[u, t(P_3)]\cup C_1\cup  P_1$. Hence, the union of $P[v_{\ell_k}, v_f] \odot P_3[v_f,v]$, $Q\odot P[v_{\ell_1},v_{\ell_k}]$, and $P_2[u,v_{\ell_k}$ is a subdivision of $P(k,1;k)$, a contradiction.
	
	\item If $v\in P_1$, let $u$ be the last vertex on $P_1\cap P_3$ along $P_3$.  Observe that $P_3[v,u]$ is also a subpath of $P_1$ and therefore contains no vertex of $P_2$. Furthermore, there is a dipath $Q$ from $u$ to $v_{\ell_k}$ in $P_3[u, t(P_3)]\cup C_1\cup  P_2$.
	The union of $P[v_{\ell_k}, v_f] \odot P_3[v_f,u]$, $P_1[u, v_{\ell_1}]\odot P[v_{\ell_1}, v_{\ell_k}]$ and $Q$ is a subdivision of $P(k,1;k)$, a contradiction.

	\end{itemize}

\end{itemize}
\end{subproof}
\end{proof}




\begin{lemma}\label{lem:col-union-cycle}
Let ${\cal C}$ be a suitable collection of directed cycles in a $P(k,1;k)$-\free\ digraph.
There exists a proper colouring $c$ of $\bigcup{\cal C}$ with $2\cdot \col + 18k$ colours, such that, each subpath of length $9k$ of each cycle of $\mathcal{C}$ is rainbow-coloured.
\end{lemma}
\begin{proof}
We prove by induction on the number of cycles in $\mathcal{C}$ the following stronger statement:
{\it if there exists
a partial colouring $c$ such that one of the cycle $C_1$ has a path of length less than $9k$
which is rainbow-coloured, then we can extend this colouring to all $D[\mathcal{C}]$ using less
than $2\col +18k$ colours such that, on each cycle, every subpath of length
$9k$ is rainbow-coloured}.

Consider a rainbow-colouring of a subpath of length less than $9k$ of a cycle $C_1\in {\cal C}$.
By Lemma \ref{lem:IC}, we can extend this colouring to a colouring $c_1$ of $I(C_1)$ at most $2\cdot \col + 18k$ colours.
Note that the non-coloured vertices of $\bigcup{\cal C}$ are in one of the connected components of $\bigcup{\cal C} - I(C_1)$.
Let $A$ be a connected component of $\bigcup{\cal C} - I(C_1)$. The coloured (by $c_1$) vertices of ${\cal C}\cap A$ are those of $({\cal C}\cap A)-A$. Hence, by Lemma \ref{lem:A}, they all belong to some cycle $C_j$ and so to the diptah $Q_j$ which has length at most $9k$.
Hence, by the induction hypothesis, we can extend $c_1$ to $A$. Doing this for each component, we extend $c_1$ to the whole $\bigcup{\cal C}$.
\end{proof}





\begin{lemma}\label{lem:DC}
Let ${\cal C}$ be a suitable collection of directed cycles in a $P(k,1;k)$-\free\ digraph $D$.
For every strongly connected component $\mathcal{S}$ of $\bigcup \mathcal{C}$, 
$\chi(\mathcal{S}) < (2\cdot \col + 18k) \cdot (2 \cdot \dr)$.
\end{lemma}

Consider the colouring $c$ obtained by lemma \ref{lem:col-union-cycle}. It allows us 
to deal with the arcs belonging to cycles in $\mathcal{C}$, to deal with the other, we do the following:
We present a sort BFS for $\mathcal{S}$.
Let $C_r$ (for root) be a cycle of $\mathcal{S}$ and $L_0 = \{C_r\}$. For every cycle $C_s$ of $\mathcal{S}$ for which 
$P_{r,s}$ is not empty, we put $C_s$ in $L_1$ and say that $C_0$ is the \textit{father} of $C_s$. We build $L_i$ inductively
until we cover all cycle of $\mathcal{S}$ : $L_{i+1}$ consists of every cycle $C_l$ not in $\cup_{j \leq i} L_j$ such that 
there exists a cycle $C_a \in L_i$ such that $P_{a,l}$ is non empty. $C_a$ is the father of $C_l$ and it is important to note that we 
fix it uniquely, even though there might exists multiple choices for a father of $C_a$ in $L_i$. We define the \textit{ancestors} of 
cycle like in trees.


Let $C_l$ be a cycle and $C_a$ its father. 
%let $Q_l$ be the subdipath of $C_l$ which contains
%all the vertices that are at distance at most $k$ from $P_{l,a}$ in the cycle underlying $C_l$.
%Then the dipath $C_l[s(Q_l), s_{l,a}]$ and  $C_j[t_{a,l},t (Q_l)]$ have length $k$.
%Set $Q^-_l=C[s(Q_l), s_{l,a}[$ and $Q^+_l=C]t_{l,a}, t(Q_l)]$.

Let $Q^-_l$ be the set of vertices $x$ of $C_l \setminus C_a$ such that the path $C_l[t_{a,l}, x]$ is longer than $k$. 
We denote by $Q^+_l$ $C_l \setminus( C_a \cup Q^-_l) $. Note that for a vertex $x$ in  $Q^+_l$, $C_l[x,s_{a,l}]$ is longer than $k$. 

For a vertex $x$ belonging to cycles in $\mathcal{S}$, we say that $x$ \textit{belongs to}  $L_i$ if
$i$ is the smallest integer such that $x \ C_l$ for some $C_l \in L_i$.

\begin{lemma}\label{lem:Qpos}
Suppose there exists a vertex $x$ such that $x \in Q^+_l$ and $x \in C_s$ for some cycles $C_l$ and $C_s$ in some $L_j$.
If $x$ belongs to $L_j$ then  $x \in  Q^+_s$ or $D$ contains a subdivision of $P(k,1;k)$
\end{lemma}

\begin{proof}
Suppose $x$ belongs to $L_j$ and $x \not \in  Q^+_s$. We can assume $x = l_{s,l}$.
Let $C_{l'}$ and $C_{s'}$ be the father of $C_l$ and $C_s$ (they can be the same). 
By definition of the $L_i$ there exists a dipath $P$ from $s_{l,l'}$ to $l_{s,s'}$ only going through $C_{l'}$, $C_{s'}$ and their ancestors.
In particular $P$ is disjoint from $C_l \setminus C_{l'}$ and  $C_s \setminus C_{s'}$
Let $y$ be the first vertex of $P$ which belongs to $C_s$. Then we find a subdivision of $P(k,1;k)$ between $x$ and $y$.
The first path is $C_s[y,x]$ longer than $k$, the second is $C_l[x,s_{l,l'}] \odot P[ s_{l,l'}, y]$ and the last is $C_s[x,y]$.
\end{proof}

The same works for $Q^-$:

\begin{lemma}\label{lem:Qneg}
Suppose there exists a vertex $x$ such that $x \in Q^-_l$ and $x \in C_s$ for some cycles $C_l$ and $C_s$ in some $L_j$.
If $x$ belongs to $L_j$ then  $x \in  Q^-_s$ or $D$ contains a subdivision of $P(k,1;k)$
\end{lemma}


%\begin{lemma}\label{lem:Ql}
%Suppose there exists an arc between $x_1 \in C_{l_1}$ and $x_2 \in C_{l_2}$. If $C_{l_1}$ and $C_{l_1}$ both belong to the same
%$L_j$ then $x_1 \in Q_{l_1}$ and $x_2 \in Q_{l_2}$. 
%\end{lemma}

%\begin{proof}
%Suppose $x_1 \not \in  Q_{l_1}$. 
%Let $C_{s_1}$ and $C_{s_1}$ be the fathers of $C_{l_1}$ and  $C_{l_2}$.
%Let $P$ be the path from $P{l_1,s_1} to P{l_2,s_2}$ in the union of $L_t$ for $t<j$ and $x$
%and $y$ are the first and last vertices of this dipath. 
%We distinguishes between three different cases, regarding the intersection of $C_{l_1}$ and  $C_{l_2}$.
%\begin{itemize}
%	\item Suppose they don't intersect. 
%	Then we find a subdivision of $P(k,1;k)$ between $y$ and $x_1$. 
%	The long paths are $C_{l_1}[y,x_1]$ and $C_{l_1}[x_1,y]$ and the last is $(x_1,x_2) \odot C_{l_2}[x_2,y] \odot P$.
%	\item Suppose they intersect By lemmas \ref{lem:Qneg} and \ref{lem:Qpos}
%\end{itemize}
%
%\end{proof}
We define $Q^+(r)$ (resp $Q^-(r)$) a partition of the vertices coloured $r$ in $c$ as follow:
If $x$ belongs to $L_j$ and, for all cycle $C_l$ in $L_j$ such that $x \in C_l$, $x \in Q^+_l$ then $x \in Q^+(r)$.
If all cycle $C_l$ in $L_j$ such that $x \in C_l$, $x \in Q^-_l$ then $x \in Q^-(r)$.
By lemmas \ref{lem:Qpos} and \ref{lem:Qneg}, this is indeed a partition of the vertices coloured $r$ in $c$.
Thus, if for every $r$ we can colour the graph $D_r^+$ induced on $D$ by the vertices in 
$Q^+(r)$ with $\dr$ colours, then we can colour the graph induced by a $\mathcal{S}$ using 
$(2\cdot \col + 18k) \cdot (2 \cdot \dr)$ colours.  


\begin{lemma}\label{lem:lvl}
Let $x$ and $y$ be vertices of $Q^+(s)$ belonging to $L_i$ and $L_j$, such that $i-j> k$ then there is no arc between $x$ and $y$.
\end{lemma}

\begin{proof}
Let $C_x$ be the cycle of $L_i$ such that $x \in C_x$ and $C_y$ the cycle of $L_j$ such that $y \in C_y$.
By considering the common ancestor of $C_x$ and $C_y$, we obtain a sequence of cycle $C_1 \dots C_p$ such that $C_1 = C_x$ and $C_p = C_y$
and $P_{i,i+1}$ exists for all $i$ between 1 and $l-1$.
If the arc is from $x$ to $y$, then we find a subdivision of $P(k,1;k)$ between $l_{p-1,p}$ and $y$. 
First note that by definition of the $L_i$, the dipaths $C_{i-1}[l_{i-1,i}, l_{i-2,i-1}]$ are all disjoint. 
Then the path $P = C_{p-1}[l_{p-1,p}, l_{p-2,p-1}] \odot C_{p-2}[l_{p-2,p-1}, l_{p-3,p-2}] \dots \odot C_{2}[l_{2,3}, s_{2,1}] 
\odot C_1[s_{2,1}, x]$ is longer than $k$. The subdivision consists of $P \odot (xy)$, $C_l[l_{p-1,p}, y]$ and $C_l[y,l_{p-1,p}]$.
The case where the arc is from $y$ to $x$ is similar.
\end{proof}

\begin{lemma}
$\chi(D_r^+) < \dr$
\end{lemma}

\begin{proof}
We use the following partition of the arcs of $D_r^+$

\begin{itemize}
	\item $A_0$ is the set of arcs of $D_r^+$ which ends belong to different levels.
	\item $A_1$ is the set of arcs of $D_r^+$ which ends belong to the same levels.
\end{itemize} 

By lemma \ref{lem:lvl}, $\chi(D_r^+[A_0]) \geq k$. Indeed, assign to each level $L_i$ the colour $i$ modulo $k$ and
we obtain a proper colouring.

We will now prove that $\chi(D_r^+[A_1]) \geq k$ by contradiction. 
Suppose it is not, it means that there exists a level $i$ such that the chromatic number of $\chi(D_r^+[A_1])$ in this level is greater 
than $k$. This means there exists a dipath $P$ of length $k$ in this level between vertices $x$ and $y$. Suppose this path visits twice 
the same cycle $C_1$ of $\mathcal{C}$. Because all the points belonging to the path received colour $r$ in $c$ this means there exists a 
handle between two points at distance at least $9k$ of the cycle $C_1$ in $\mathcal{C}$, which is impossible. 
Consider $C_x$ and $C_y$ cycles containing $x$ and $y$ in $L_i$ and $C_{x'}$, $C_{y'}$ their respective father. 
By considering the common ancestor of $C_{x'}$ and $C_{y'}$, we can find a dipath $P_y$ from $l_{y,y'}$ to $s_{x,x'}$ which 
only uses vertices in levels smaller than $i-1$, thus disjoint of $P$, $C_y[l_{y,y'}, y]$, $C_y[y, l_{y,y'}]$ and $C_x[s_{x,x'}, x]$. 
Then $C_y[l_{y,y'}, y]$, $C_y[y, l_{y,y'}]$ and $P_y \odot C_x[s_{x,x'}, x] \odot P$ form a subdivision of $P(k,1;k)$ between $y$ 
and $l_{y,y'}$. 

By lemma \ref{lem:decomp} this means $\chi(D_r^+) <  \dr$ 

\end{proof}

\section{Proof of Theorem \ref{th:main}}

Consider $\mathcal{C}$ be a maximal suitable collection of cycles in $D$. Let $D'$ be the digraph obtained by contracting 
every connected component $S$ of $\bigcup \mathcal{C}$ into one vertex. For each connected component $S_i$ we call $s_i$ the
new vertex created.

\begin{claim}\label{cl:nocycle}
$\chi(D') \leq 12k$
\end{claim} 

\begin{proof}
First note that since $D$ is strongly connected so is $D'$. If $\chi(D') > 12k$ then by Bondy's Theorem, there exists
a directed cycle $C = x_1x_2 \dots x_l$ of length greater than $12k$. From $C$ we deduce a cycle $C'$ in $D$ in the following way: 
\begin{itemize}
	\item We keep the vertices of $D'$ which correspond to vertices in $D$.
	\item For each vertex $x_j$ which correspond to a $s_i$ in $D$: the arc $x_{j-1}x_j$ corresponds in $D$ to an arc arriving on 
		$p_i$, a vertex of $S_i$ and the arc $x_jx_{j+1}$ corresponds to an arc leaving $l_i$, a vertex of $S_i$. Let $P_j$ be the dipath 
		from $p_i$ to $l_i$ in $\bigcup \mathcal{C}$. Note that this path intersect the element of $S_i$ only along a subpath. 
\end{itemize}
$C'$ is then the path obtained from $C$ where we replace all contracted point $x_j$ by the path $P_j$. 
First note that $C'$ has size greater than $12k$. Moreover, let $C_i$ be a cycle of $\mathcal{C}$, then $C_i$ can
intersect $C'$ only along one $P_j$, because they all correspond to different component of $\bigcup \mathcal{C}$. This mean the
intersection of $C'$ to each cycle of $\mathcal{C}$ is along a subpath. If this intersection is along a subpath longer than $k$ than we can 
find a subdivision of $P(k,1;k)$. So $C'$ is a directed cycle of length at least $12k$ which intersect every cycle of $\mathcal{C}$ along a 
subdipath of length at most $k$. This contradicts the maximality of $\mathcal{C}$ and $\chi(D') \leq 12k$.
\end{proof}


So this means by using $12k \cdot (2\cdot \col + 18k) \cdot (2 \cdot \dr)$ we can colour $D$.



\end{document}
