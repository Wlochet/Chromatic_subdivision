% EJC papers *must* begin with the following two lines.
\documentclass[utf8,10pt]{article}
\usepackage[utf8]{inputenc}
\usepackage{fullpage}


% Please remove all other commands that change parameters such as
% margins or pagesizes.

% only use standard LaTeX packages
% only include packages that you actually need

% we recommend these ams packages
\usepackage{amsthm,amsmath,amssymb}
\usepackage{algorithm2e}
\newcommand{\qedclaim}{\hfill $\diamond$ \medskip}
\newenvironment{proofclaim}{\noindent{\em Proof of the claim.}}{\qedclaim}

% we recommend the graphicx package for importing figures
%\usepackage{graphicx}

% use this command to create hyperlinks (optional and recommended)
\usepackage[colorlinks=true,citecolor=black,linkcolor=black,urlcolor=blue]{hyperref}

% use these commands for typesetting doi and arXiv references in the bibliography
\newcommand{\doi}[1]{\href{http://dx.doi.org/#1}{\texttt{doi:#1}}}
\newcommand{\arxiv}[1]{\href{http://arxiv.org/abs/#1}{\texttt{arXiv:#1}}}

% all overfull boxes must be fixed;
% i.e. there must be no text protruding into the margins


% declare theorem-like environments
\theoremstyle{plain}
\newtheorem{theorem}{Theorem}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{fact}[theorem]{Fact}
\newtheorem{observation}[theorem]{Observation}
\newtheorem{claim}{Claim}[theorem]

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{open}[theorem]{Open Problem}
\newtheorem{problem}[theorem]{Problem}
\newtheorem{question}[theorem]{Question}

\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{note}[theorem]{Note}

\usepackage{thm-restate}

\newcommand{\william}[1]{{\color{red}{\bf William:} #1}}
\newcommand{\nathann}[1]{{\color{blue}{\bf Nathann:} #1}}

\newenvironment{subproof}{\par\noindent {\it Subproof}.\ }{\hfill$\lozenge$\par\vspace{11pt}}

\newcommand{\cste}{\bf cste}
\newcommand{\col}{(8k^2)^{4k}}
\newcommand{\free}{subdivision-free}

\DeclareMathOperator{\Dis}{Dis}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% if needed include a line break (\\) at an appropriate place in the title

\title{Some paths and chromatic number}



\begin{document}

\maketitle

\section{Definitions and preliminaries}
%%%%%%%%%%%%%%%%%%


We denote by $[k]$ the set of integers $\{1, \dots , k\}$.

Let $F$ be a digraph.
A digraph $D$ is said to be {\it $F$-subdivision-free}, if it contains no subdivision of $F$.

The {\it union} of two digraphs $D_1$ and $D_2$ is the digraph  $D_1\cup D_2$ defined by $V(D_1\cup D_2) = V(D_1)\cup V(D_2)$ and 
$A(D_1\cup D_2) = A(D_1)\cup A(D_2)$.
If ${\cal D}$ is a set of digraphs, we denote by $\bigcup {\cal D}$ the union of the digraphs, i.e. $V(\bigcup {\cal D}) =\bigcup_{D\in {\cal D}} V(D)$
and $A(\bigcup {\cal D}) =\bigcup_{D\in {\cal D}} A(D)$.



{\bf def de dipath}

Let $P$ be a path. We denote by $s(P)$ its initial vertex and by $t(P)$ its terminal vertex.
The subpath of $P$ with initial vertex $u$ and terminal vertex $v$ is denoted by $P[u,v]$.
Similarly, if $C$ is a directed cycle, we denote by $C[u,v]$ the subdipath of $C$ with initial vertex $u$ and terminal vertex $v$.


Let $k_1,k_2,k_3$ be positive integers. Let $P(k_1,k_2;k_3)$ be the digraph formed by three internally disjoint paths between two vertices $x,y$, two $(x,y)$-dipaths, one of size at least $k_1$, the other of size at least $k_2$, and one $(y,x)$-dipath of size at least $k_3$.
When we want to insist on the vertices $x$ and $y$, we denote it by $P_{xy}(k_1,k_2;k_3)$.


The {\it connected components} of a digraph are the connected components of its underlying graph.

Let $c$ be a colouring of a graph $G$. A subset of vertices or a subgraph $S$ of $G$ is {\it rainbow-coloured} if all vertices of $S$ have distinct colours.


A (directed) graph $G$ is {\it $k$-degenerate} if every subgraph $H$ of $G$ has a vertex of degree at most $k$.
The following proposition is well-known.
\begin{proposition}[useful??]\label{prop:deg}
Every $k$-degenerate (directed) graph is $(k+1)$-colourable.
\end{proposition}





We will need the following lemmas:

\begin{lemma}[useful??]\label{walk}
Let $D$ be a digraph and $W$ a walk of length $t^l$ such that every vertex appears at most $t$ times.
Then there exists a dipath of length $l$ starting with the first vertex of $W$.
\end{lemma}

\begin{proof}
We do it by induction on $l$. Let $x$ be the first vertex of $W$, because $x$ appears at most $t$ times, there exists a subpath of length greater
than $t^l/t$ not containing $x$. If we apply induction to the longest of such path, then we find a path of length $l-1$ without $x$ such that
 the first vertex is an out-neighbour of $x$.

\end{proof}

\begin{lemma}\label{min}
Let $\sigma=(u_t)_{t\in [p]}$ be a sequence of integers in $[k]$. If $p\geq l^k$, then there exists a set $L$ of $l$ indices such that for any $i,j \in L$ with $i < j$ the following holds : $u_i=u_j$ and $u_k > u_i$, for all $i < k < j$.
\end{lemma}

\begin{proof}
By induction on $k$, the result holding trivially when $k=1$. Assume now that $k>1$. Let $L_1$ be the elements of the sequence with value $1$. If $L_1$ has at least $l$ elements, we are done.
If not then there is a subsequence $\sigma'$ of $l^k/l$ consecutive elements in $\{2, \dots , k-1\}$. Applying the induction hypothesis to $\sigma'$ yields the result.
\end{proof}

\begin{lemma}\label{max}
Let $\sigma=(u_t)_{t\in [p]}$ be a sequence of integers in $[k]$. 
If $p > k (m-1)$, then there exists a subsequence of $m$ consecutive integers such that the
last one is the largest.
\end{lemma}

\begin{proof}
By induction on $k$, the result holding trivially when $k=1$. 
Let $i$ be the smallest integer such that $u_t\leq k-1$ for all $i\leq t\leq p$.
If $i>m$, then $u_{i-1}=k$, and the subsequence of the $i-1$ first elements of $\sigma$ is the desired sequence.
If $i\leq m$, apply the induction on $\sigma'=(u_t)_{i\leq t\leq p}$ which is a sequence of more than $(k-1)(m-1)$ integers in $[k-1]$, to get the result. 
\end{proof}











\section{$P(k,1;k)$}
%%%%%%%%%%%

\begin{theorem}
Let $D$ be a strongly connected digraph. If $\chi(D) > \cste$, then $D$ contains a subdvision of $P(k,1;k)$.
\end{theorem}
\begin{proof}
We prove the result by the contrapositive. We consider a digraph $D$ that contains no subdivision of $P(k,1;k)$.
We shall prove that $\chi(D) \leq \cste$.

\subsection{Suitable collections of directed cycles}
%%%%%%%%%%%%%%%%%%%%%%%%%


A collection ${\cal C}$ of directed cycles is {\it suitable} if all cycles of ${\cal C}$ have length at least $12k$, and for
any two distinct cycles $C_i,C_j\in\mathcal C$ intersect on  subpath $P_{i,j}$ of order at most $k$.
We denote by $s_{i,j}$ (resp. $t_{i,j}$) the initial (resp. terminal) vertex of  $P_{i,j}$.
 
 
 
 
 
 \begin{lemma}\label{lem:dis}
 Let ${\cal C}$ be a suitable collection of directed cycles in a $P(k,1;k)$-\free\ digraph.
Let $C_1,C_2,C_3\in\mathcal C$ pairwise intersect, and let $v$ belong to $V(C_2)\cap V(C_3)\setminus V(C_1)$. Then exactly one of the following holds:
\begin{itemize}
\item $C_2[t_{1,2}, v]$ and $C_3[t_{1,3}, v]$ have both length at most $4k$; 
\item $C_2[v, s_{1,2}]$ and $C_3[v, s_{1,3}]$ have both length at most $4k$.
\end{itemize}
\end{lemma}

\begin{proof}
Suppose it is not the case. By symmetry, we may assume that $C_3[t_{1,3},v]$ has length at most $4k$ and
$C_2[v, s_{1,2}]$ has length at most $4k$, so  $C_2[t_{1,2},v]$ has length greater than $4k$.

Observe that $t_{2,3}\notin V(C_1)$ for otherwise $C_3[v,t_{1,3}]$ has length less than $2k$ (since it is contained in $P_{2,3}\cup P_{1,3}$ and each of those paths has length at most $k-1$ by definition of ${\cal C}$) and so $C_3[t_{1,3},v]$ has length at least $10k$, a contradiction.
We distinguish two cases according to the position of $s_{1,3}$ in $C_1$ relatively to $s_{1,2}$ and $t_{1,2}$.

\begin{itemize}
	\item Assume $s_{1,3}\in C_1[s_{1,2},t_{1,2}]$. The dipath  $C_3[s_1,3,t_{2,3}]$ is contained in $P_{1,2}\cup P_{2,3}$ and has lentgh less than $2k$. So $C_3[t_{2,3}, s_{1,3}]$ has length at least $k$. Moreover, $C_1[s_{1,3}, t_{1,2}]\odot C_2[t_{1,2}, t_{2,3}]$ contains $C_1[t_{1,2}, v]$  and so has legth at least $4k$. Consequently, the union of $C_1[s_{1,3}, t_{1,2}]\odot C_2[t_{1,2}, t_{2,3}]$, $C_3[t_{2,3}, s_{1,3}]$, and
$C_2[t_{2,3}, s_{1,2}]\odot C_1[s_{1,2}, s_{1,3}]$ is a subdivision of $P(k,1;k)$, a contradiction.

	\item Assume now that $s_{1,3}\in C_1[t_{1,2},s_{1,2}]$. The dipath  $C_2[s_{1,2}, t_{2,3}]$ has length greater than $4k$ because it contains $C_2[t_{1,2},v]$. Moreover, the dipath $C_3[s_{1,3}, t_{2,3}]$ is contained in $P_{1,3}\cup C_3[t_{1,3},v]$, and so has length at most $5k$.
	Thus $C_3[t_2,3, s_{1,3}]$ has length at least $7k$.
	 Consequently, the union of $C_2[s_{1,2}, t_{2,3}]$, $C_3[t_2,3, s_{1,3}]\odot C_1[s_{1,3}, s_{1,2}]$, and $C_2[t_{2,3}, s_{1,2}]$ is a subdivision of $P(k,1;k)$, a contradiction.
\end{itemize}
\end{proof}
 
 
 
 
 
 
% Let $D[\mathcal{C}]$ be the graph induced on $D$ by the vertices in $\mathcal{C}$ and let $D'$ be the subdigraph of $D[\mathcal{C}]$ with vertex set $V(D)$ and arc set  $\bigcup_{C\in {\cal C}} A(C)$.

Let ${\cal C}$ be a suitable collection of directed cycles.
For every set of vertices or digraph $S$, we denote by ${\cal C}\cap S$ the set of cycles of ${\cal C}$ that intersect $S$. 



Let $C_1\in \mathcal{C}$.
For each $C_j\in {\cal C} \cap C_1$, let $Q_j$ be the subdipath of $C_j$ such that
containing all the vertices that are at distance at most $4k$ from $P_{1,j}$ in the cycle underlying $C_j$.
Then the dipath $C_j[s(Q_j), s_{1,j}]$ and  $C_j[t_{1,j},t (Q_j)]$ have length $4k$.
Set $Q^-_j=C[s(Q_j), s_{1,j}[$ and $Q^+_j=C]t_{1,j}, t(Q_j)]$.


Set $I^+(C_1) = \bigcup_{C_j\in {\cal C}\cap C_1} Q^+_j$ and $I^-(C_1) = \bigcup_{C_j\in {\cal C}\cap C_1} Q^-_j$.
Observe that Lemma~\ref{lem:dis} implies that $I^+(C_1)$ and $I^-(C_1)$ are vertex-disjoint digraphs. We set $I(C_1)=I^+(C_1)\cup I^-(C_1)$.




\begin{lemma}\label{lem:A}
Let ${\cal C}$ be a suitable collection of directed cycles in a $P(k,1;k)$-\free\ digraph.
Let $C_1$ be a cycle of ${\cal C}$ and let $A$ be a connected component of $\bigcup{\cal C} - I(C_1)$.
All vertices of $({\cal C}\cap A)  - A$ belongs to a unique cycle $C_A$ of $\mathcal{C}$.
\end{lemma}

\begin{proof}
Suppose it is not the case. Then there are two distinct cycles $C_2, C_3$ of ${\cal C}\cap A$ that intersect with $C_1$.

Let $t$ be the closest vertex among $\{t_{1,2}, t_{1,3}\}$ in $C_1$ and let $t'$ be the other vertex of $\{t_{1,2}, t_{1,3}\}$.
(If $t_{1,2}=t_{1,3}$, then $t=t'$.) For $i=2,3$, let $R_i$ be the $(t,t(Q_i)$-dipath in $C_1\cup Q_i$. Observe that $R_i=Q_i$ or $R_i=C_1[t,t']\cup Q_I$. Hence $R_i$ has length at least $4k$.
Let $v$ be the last vertex in $R_2\cap R_3$ along $R_2$. (This vertex exists since $t\in R_2\cap R_3$.) In $A$, there exists a $(t(Q_3), C_2)$-dipath $R_A$. Let $w$ be its terminal vertex. By definition of $A$, $w$ is in $C_2[t(Q_2, s(Q_2)]$, therefore $C_2[w,v]$ has length at least $4k$ since it contains $C_2[s(Q_2), s_{1,2}]$. Consequently, both $R_2[v,t(Q_2)]$ and $R_3[v,t(Q_3)]$ have length less than $k$ for otherwise the union of $C_2[w,v]$, $C_2[v,w]$ and $R_3[v,t(Q_3)]\odot R_A$ would be a subdivision of $P(k,1;k)$.
In particular, $v\neq t$. This implies that $s_{2,3}\in V(R_2\cap R_3)$.
Moreover, $R_2[s_{2,3}, t(Q_2)]$ has length at most $2k$ because $R_2[s_{2,3},v]$ is a subdipath of $P_{2,3}$ and so has length at most $k$.
Therefore $R_2[t,s_{2,3}]$ has length at least $2k$ because $R_2$ has length at least $4k$.
It follows that the union of $C_2[s_{2,3},t]$,  $R_2[t,s_{2,3}]$ and  $R_3[t,s_{2,3}]$ is a subdivision of $P(k,1;k)$, a contradiction.
\end{proof}




\begin{lemma}\label{lem:no-dicycle}
If ${\cal C}$ is a suitable collection of directed cycles in a $P(k,1;k)$-\free\ digraph, then
$I^+(C_1)$ has no directed cycle.  
\end{lemma}
\begin{subproof}
Suppose for a contradiction that $I^+(C_1)$  contains a directed cycle $C'$.
Clearly, it must contain arcs from at least two $Q^+_j$.



Assume that $C'$ contains several vertices of $Q^+_j$.
Necessarily, there must be two vertices $x,y$ of $Q^+_j\cap C'$ such that no vertex of $C']x,y[$ is in $C_j$ and  $y$ is before $x$ in $Q^+_j$.
Therefore $C'[x,y]\odot Q^+[y,x]$ is also a directed cycle in $I^+(C_1)$. Free to consider this cycle,
we may assume that $C'\cap Q^+_j$ is a directed path.

Doing so, for all $j$, we may assume that $C'\cap Q^+_j$ is a directed path  for every $C_j\in {\cal C}\cap C_1$.
Without loss of generality, we may assume that there are cycles $C_2, \dots , C_p$ such that
\begin{itemize}
\item $C'$ is in $Q^+_2\cup \cdots  \cup Q^+_p$;
\item for all $2\leq j\leq p$, $C'\cap Q^+_j$ is a directed path $P^+_j$ with initial vertex $a_j$ and terminal vertex $b_j$;
\item the $a_j$ and the $b_j$ appear according to the following order around $C'$: $(a_2, b_p, a_3, b_2, \dots ,   a_p, b_{p-1}, a_2)$ with possibly $a_{j+1}=b_j$ for some $1\leq j \leq p$ where $a_{p+1}=a_2$.
\end{itemize}
For $2\leq j\leq p$, set $B_j=C_j[b_j, a_j]$. Note that $B_j$ has length at least $7k$, because $Q^+_2$ has length at most $5k$.


Consider the closed directed walk $$W=C_p[a_2,b_p]\odot B_p \odot C_{p-1}[a_p, b_{p-1}] \odot  \cdots  \odot  B_3\odot C_2[a_3, b_2]\odot B_2.$$
$W$ contains a directed cycle $C_W$. Wihtout loss of generality, we may assume that this cycle is of the form
$$C_W=B_q[v, a_q] \odot C_{q-1}[a_q, b_{q-1}] \odot  \cdots  \odot  B_3\odot C_2[a_3, b_2]\odot B_2[b_2, v]$$
for some vertex $v\in B_2\cap B_r$. (The case when $W$ is a directed cycle corresponds to $q=p+1$ and $B_2=B_{p+1}$.)

Note that necessarily, $q\geq 4$, for $B_3$ does not intersect $B_2$, for otherwise $b_3=b_2$ since the intersection of $C_2$ and $C_3$ is a dipath.

Observe that $C_W[b_2,v]=C_2[b_2,v]$ or $C_W[v, a_4]$ has length at least $k$.
Indeed, if $q=p+1$, then it follows from the fact that $B_2$ has length as least $7k$; if
$5\leq q\leq p$, then it comes form the fact that $B_4$ is a subdipath of $C_W[v, a_r]$; if $q=4$, then it follows from Lemma~\ref{lem:dis}  applied to $C_3$, $C_2$, $C_4$ in the role of $C_1$, $C_2$, $C_3$ respectively.
In both case, $C_W[b_2, a_4]$ has length at least $k$. 

Furthermore, $C_W[a_4,b_2]$ has length at least $k$ because it contains $B_3$. Therefore the union of
$C_W[b_2, a_4]$, $C_W[a_4,b_2]$ and $C'[b_2,a_4]=C_3[b_3,a_4]$ is a subdivision of of $P(k,1;k)$, a contradiction.
\end{subproof}




\begin{lemma}\label{lem:IC}
Let ${\cal C}$ be a suitable collection of directed cycles in a $P(k,1;k)$-\free\ digraph.

Let $c$ be a partial colouring of $C_1$ such that only a path of length at most
$9k$ is coloured and this path is rainbow-coloured. Then $c$ can be extended into
a colouring of $C_1\cup I(C_1)$ using $2\cdot \col + 18k$ colours, such that every subpath of length at most $9k$ of $C_1$ is rainbow-coloured and  $Q_j$ is rainbow-coloured, for every $C_j\in {\cal C}\cap C_1$.\end{lemma}

\begin{proof}
We can easily extend $c$ to $C_1$ using $18k$ colours (including the at most $9k$ already used colours)
so that every subpath of $C_1$ of length $9k$ is rainbow-coloured.

We shall now prove that there exists a colouring $c^+$ of $I^+(C_1)$ with $\col$ (new) colours so that $Q^+_j$ is rainbow-coloured for every $C_j\in {\cal C}\cap C_1$, and a colouring $c^-$ of $I^-(C_1)$ with $\col$ (other new) colours so that $Q^-_j$ is rainbow-coloured for every $C_j\in {\cal C}\cap C_1$.
The union of these three colourings is clearly the desired colouring of $C_1\cup \bigcup{\cal C}[I(C_1)]$. (Observe that a vertex of $I(C_1)$ is coloured only once because  $I^+(C_1)$ and $I^-(C_1)$ are disjoint.)

It remains to prove the existence of $c^+$ and $c^-$. By symmetry, it suffices to prove the existence of $c^+$.
 To prove the existence of $c^+$ we consider an auxilary digraph $D^+_1$.
 For each $C_j\in {\cal C}\cap C_1$, let $T^+_j$ be the transitive tournament whose hamiltonian dipath is $Q^+_j$.
Let $D^+_1=\bigcup_{C_j\in  {\cal C}\cap C_1} T^+_j$. 
The arcs of the $A(T^+_j)\setminus A(Q^+_j$ are called {\it fake arcs}.
%Observe that $D^+_1$ is acyclic because $I^+(C_1)$ is. Indeed, if there were a directed cycle
%cycle in $D^+_1$, it could be transformed into a closed directed walk (by replacing each arc $(u,v)\in A(T^+_j)$, by 
%$Q^+_j[u,v]$), which would contain a directed cycle.
Clearly, $c^+$ exists if and only if $D^+_1$ admits a proper colouring. Henceforth it remains to prove the following claim.

\begin{claim}
$\chi(D^+_1) \leq  \col$.
\end{claim}

\begin{subproof}
To each vertex $v$ in $I^+(C_1)$ we associate the set $\Dis(v)$ of the lengths of the $C_j[t_{1,j},v]$ for all cycle $C_j\in {\cal C} \cap C_1$ containing $v$ such that $C_j[t_{1,j},v]$ has length at most $4k$.


Suppose for a contradiction that $\chi(D^+_1) \leq  \col$.
By Gallai-Roy Theorem, $D^+_1$ admits a path of length $\col$. Replacing all fake arcs  $(u,v)$ in some $A(T^+_j)$, by 
$Q^+_j[u,v]$ we obtain a directed walk $P$ in $I^+(C_1)$ of length at least $\col$. By Lemma \ref{lem:no-dicycle}, $P$ is necessarily a directed path. Set $P=(v_1,  \dots , v_{p})$. We have $p\geq \col$.

For $1\leq i\leq p$, let $m_i = \min \Dis(v_i)$. 
Lemma \ref{min} applied to $(m_i)_{1\leq i\leq p}$ yields  a set of $8k^2$ indices of such that 
for any $i< j \in L$,  $m_i=m_j$ and $m_k > m_i$, for all $i< k < j$.
Let $l_1 < l_2 < \cdots < l_{8k^2}$ be the elements of $L$. 


For $1\leq j\leq 8k^2-1$, let $u_j = \max \bigcup_{l_j\leq i < l_{j+1}} \Dis(v_i)$.
By definition $u_j\leq 4k$.
Applying Lemma~\ref{max} to $(u_j)_{1\leq j\leq 8k^2}$,  we get a sequence of size $2k$ $u_{j_0+1} \dots u_{j_0+{2k}}$ such that $u_{j_0+{2k}}$ is the greatest.

Let $P'$ be the subpath on $P$ between $l_{j_1}$ and the vertex $x_f$ after $l_{j_{2k-1}}$ which gives the value to $u_{j_{2k-1}}$,
moreover let $P_1$  be the path from $x_1 \in C_1$ to $l_{j_1}$ of length corresponding to the minimum value of $dis(l_{j_1})$,
$P_2$ the one for the minimum value of $dis(l_{j_k})$ between $x_2 \in C_1$ and $l_{j_k}$, and $P_3$ the path
from $x_f$ to $x_3 \in C_1$ on the cycle which corresponds to the value of $u_{j_{2k-1}}$
(some of these vertices will be outside $I(C_1)$. Note that any vertex $v$ on $P_1$ and $P_2$ has an integer in $dis(v)$
which is smaller than $(l_{j_k})$ and any vertex $v$ on $P_3$ has an integer in $dis(v)$ which
is greater than $u_{j_{2k-1}}$, or doesn't belong to $I(C_1)$. Using Lemma \ref{lem:dis}, this means
$P_1$, $P_2$ and $P_3$ are disjoint from $P'$. Let $P'_1$ be the subpath of $P'$ from $l_{j_1}$ to $l_{j_k}$ and  $P'_2$ the rest
(note that they both are longer than $k$).
We distinguishes between the intersection of $P_1$, $P_2$ and $P_3$:

\begin{itemize}
	\item Suppose $P_3$ intersects neither $P_1$ nor $P_2$.
	\begin{enumerate}
		\item If $P_1$ and $P_2 $ are not disjoints,
		then let $u$ be the last vertex on which they intersect. We find the subdivision of $P(k,1;k)$ between $u$ and $l_{j_k}$.
		The first path is from $u$ to $x_{j_k}$ along $P_1$ then $P'_1$, the second is from $x_{j_k}$
		to $u$ using $P'_2$, then $P_3$ then the path along $C_1$
		then $P_1$ to go to $u$ the last is the path from $u$ to $x_{j_k}$ along $P_2$.
		\item 	If $P_1$ and $P_2$ are disjoint. If $c_1$ is between $c_3$ and $c_2$ along the cycle $C_1$, t
		hen we find the subdivision of $P(k,1;k)$
		between $c_1$ and $l_{j_p}$. The first path is $P_1 \cdot P'_1$, the second is $P'_2 \cdot P_3$
		then the path along $C_1$ from $c_3$ to $c_1$ and the third
		is the path along $C_1$ from $c_1$ to $c_2$ then $P_2$. If $c_1$ is before
		 $c_2$ then we find the subdivision of $P(k,1;k)$ between $c_2$ and
		$l_{j_k} $. The first path is the path along $C_1$ from $c_2$ to $c_1$, then $P_2$ then $P'_1$.
		Then second is $P'_2 \cdot P_3$ then the path along $C_1$ from
		$c_3$ to $c_2$ and the third is $P_2$.
\end{enumerate}
	\item If $P_3$ intersect first a vertex $v \in P_1 \cap P_2$ then it's like last case where $P_1$ and $P_2$ intersect.
	\item Suppose $P_3$ intersects first $P_2$. Because $P_3$ and $P_2$ are path of cycles of $\mathcal{C}$
	their intersection is a path. Let $u$ be the last vertex of this intersection.
	We find a subdivision of $P(k,1;k)$ between $l_{j_k}$ and $u$.
	The first path is $P'_2$ then $P_3$ until $u$, the second is the path from $u$ to $P_1$ (either going
	through $C_1$ or not) then along $P_1$ until $l_{j_1}$ then $P'_1$, the last is from $u$ to $l_{j_k}$ along $P_1$.
	\item Suppose $P_3$ intersects first $P_1$. Let $u$ be the last vertex of $P_3$ which
	 is on $P_1$ before it goes to either $P_2$ or to $C_1$.
	We find a subdivision of $P(k,1;k)$ between $l_{j_k}$ and $u$. The first path is $P'_2$ then
	$P_3$ until $u$, the second is the path from $u$ to	$l_{j_1}$ along $P_1$ then $P'_1$,
	the third is from $u$ to $P_2$ using $P_3$ and $C_1$ if necessary then the path along $P_2$ to  $l_{j_k}$.
\end{itemize}


\end{subproof}
\end{proof}




\begin{lemma}
There exists a proper colouring $c$ of $\bigcup{\cal C}$ with $2(8k^2)^{4k} + 9k$ colours, such that, each subpath of length $9k$ of each cycle of $\mathcal{C}$ is rainbow coloured.
\end{lemma}








Now we can prove by induction on the number of cycle in $\mathcal{C}$ that if there exists
a partial colouring $c$ such that one of the cycle $C_1$ has a path of length smaller than $9k$
which is rainbow coloured, then we can extend this colouring to all $D[\mathcal{C}]$ using less
than $2(8k^2)^{4k} +9k$ colours such that, on each cycle, every subpath of length
$9k$ is rainbow coloured. By Lemma \ref{lem:IC}, we can extend this colouring to a colouring $c_1$ of $\bigcup{\cal C}[I(C_1)]$
using less than $2(8k^2)^{4k} + 9k$ colours.
Note that the remaining points of $\bigcup{\cal C}[\mathcal{C}]$ are in one of the connected components of $\bigcup{\cal C} - I(C_1)$.
Let $A$ be a connected component of $\bigcup{\cal C} - I(C_1)$, by Lemma \ref{lem:A} if we give the colours of $c_1$ to vertices of $({\cal C}\cap A) \cap I(C_1)$
only a path of length smaller than $9k$ of some cycle of $\mathcal{C}$ receive some colours,
so we can apply the induction hypothesis to all ${\cal C}\cap A$ to get a colouring
of the vertices of $A$ which is compatible with $c_1$. By doing this to each component, we finish the proof.


\medskip

%Now it remains to colour the edges between cycles of $\mathcal{C}$ in each connected component.
%Let $C_r$ be a cycle of $\mathcal{C}$. We let $L_1$ be the set of cycle of $\mathcal{C}$ which intersect
%$C_1$. For each cycle $L_1$ of
%
%
%For each cycle $C_i$ in the same component as $C_2$, there exists a
%sequence of cycle $C_1 = C_r$ $C_2$, $\dots C_l = C_i$ such that, for all $j$, $C_j$ qnd $C_{j+1}$ intersect on an non empty path.
%We can assume this sequence is the shortest possible, and this define a distance between $C_r$ and $C_i$.
%We will colour the set of vertices who belongs to a cycle at distance $i$ of $C_r$.
%
%\begin{lemma}
%Let $C_i$ and $C_j$ be two cycles at distance $l$ of $C_r$ and $C_{i'}$ and $C_{j'}$ be the cycle preceding $C_i$ and $C_j$ on their path to $C_r$.
%Suppose $P_{i,i'}$ and $P_{j,j'}$ are disjoint.
%There exists a path from the last vertex of $P_{i,i'}$ to the first vertex of $P_{j,j'}$ and one from the first vertex of $P_{j,j'}$ to the last of
%$P_{i,i'}$ . One of these path is of size greater than $k$ and they only uses vertices of cycle at distance less than $l$ of $C_r$.
%\end{lemma}
%
%\begin{proof}
%flemme
%\end{proof}


\begin{claim}\label{DC}
$\chi(D[\mathcal{C}]) < ? $
\end{claim}






\end{proof}



\end{document}
